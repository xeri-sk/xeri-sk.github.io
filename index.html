<html>
  <head>

  <!-- 
  
  NOTE: This plugin will not be visible on public views of a channel. 
        If you intend to make your channel public, consider using the
        MATLAB Visualization App to create your visualizations.
  
  -->  
  <style type="text/css">
  body { background-color: #ddd; }
  #gauge_div_temp { float: left;}
  #gauge_div_humi { float: left;}
  
  /*
  #container { height: 100%; width: 100%; display: table; }
  #inner { vertical-align: left; display: table-cell; }
  #gauge_div { width: 120px; margin: 0 auto; }
  */
</style>



  <title>Google Gauge - ThingSpeak</title>
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
<script type='text/javascript' src='https://www.google.com/jsapi'></script>
<script type='text/javascript'>
   // set your channel id here
  var channel_id = 1289568;
  // set your channel's read api key here if necessary
  var api_key = 'C3O58RRHRTD78GVU';
  // maximum value for the gauge
  //var max_gauge_value = 70;
  // name of the gauge
  //var gauge_name = 'Temp';

  // global variables
  var chart1, chart2, options1, options2, charts, data;

  // load the google gauge visualization
  google.load('visualization', '1', {packages:['gauge']});
  google.setOnLoadCallback(initCharts);
  
  

  // initialize the chart
  function initCharts() {

    data = new google.visualization.DataTable();
    data.addColumn('string', 'Label');
    data.addColumn('number', 'Value');
    data.addRows(1);
    
    chart1 = new google.visualization.Gauge(document.getElementById('gauge_div_temp'));
    options1 = {width: 250, height: 250, 
               min: 20, max: 36,
               // RED
               greenFrom: 20, greenTo: 36, greenColor: '#DC3912',
               // GREEN
               redFrom: 27, redTo: 31, redColor: '#109618',
               // YELLOW
               yellowFrom:24, yellowTo: 34, yellowColor: 'yellow',
               animation:{
                duration: 2000,
                easing: 'inAndOut',
                },
               majorTicks: [
                '20', '22',  '24', '26',  '28', '30', '32', '34', '36' ]
              };
			  
	chart2 = new google.visualization.Gauge(document.getElementById('gauge_div_humi'));
    options2 = {width: 250, height: 250, 
               min: 0, max: 100,
               // RED
               greenFrom: 0, greenTo: 50, greenColor: '#DC3912',
               // GREEN
               redFrom: 50, redTo: 70, redColor: '#109618',
               // YELLOW
               yellowFrom:70, yellowTo: 100, yellowColor: 'yellow',
               animation:{
                duration: 2000,
                easing: 'inAndOut',
                },
               majorTicks: [
                '0', '20', '40',  '60', '80',  '100' ]
              };
			  
    loadData();

    // load new data every 15 seconds
    setInterval('loadData()', 5000);
  }
  
  
   // load the data
  function loadData() {
    // variable for the data point
    var t, h;

    // get the data from thingspeak
    $.getJSON('https://api.thingspeak.com/channels/' + channel_id + '/feed/last.json?api_key=' + api_key, function(data) {

      // get the data point
      t = data.field1;
	  h = data.field2;
      
      // if there is a data point display it
      if (t) {
        // p = Math.round((p / max_gauge_value) * 100);
        displayDataTemp(t);
      }
	  
	  if (h) {
        // p = Math.round((p / max_gauge_value) * 100);
        displayDataHumi(h);
      }
    });
  }
  
  
  // display the data
  function displayDataTemp(point) {
    data.setValue(0, 0, 'Temp');
    data.setValue(0, 1, point);
    
     var formatter = new google.visualization.NumberFormat(
          {suffix: 'Â°C',pattern:'#'}
          );
        formatter.format(data,1);
    
    chart1.draw(data, options1);
}
  
  // display the data
  function displayDataHumi(point) {
    data.setValue(0, 0, 'Humi');
    data.setValue(0, 1, point);
    
     var formatter = new google.visualization.NumberFormat(
          {suffix: '%',pattern:'#'}
          );
        formatter.format(data,1);
    
   chart2.draw(data, options2);
  }

 

  
/*
  function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses'],
          ['2004',  1000,      400],
          ['2005',  1170,      460],
          ['2006',  660,       1120],
          ['2007',  1030,      540]
        ]);

        var options = {
          title: 'Company Performance',
          curveType: 'function',
          legend: { position: 'bottom' }
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

         

        chart.draw(data, options);
      }
  
	  google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);
	*/  
  </script>
 
 


  </head>

  <body>
    <div id="container">
      <div id="inner">
        <div id="gauge_div_temp"></div>
		<div id="gauge_div_humi"></div>
        <div id="curve_chart" style="width: 900px; height: 500px"></div>
      </div>
    </div>
  </body>
</html>

