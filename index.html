<html>
  <head>

  <!-- 
  
  NOTE: This plugin will not be visible on public views of a channel. 
        If you intend to make your channel public, consider using the
        MATLAB Visualization App to create your visualizations.
  
  -->  
  <style type="text/css">
  body { background-color: #ddd; }
  #gauge_div_temp { float: left;}
  #gauge_div_humi { float: left;}
  #gauge_div_heat { float: left;}
  
  /*
  #container { height: 100%; width: 100%; display: table; }
  #inner { vertical-align: left; display: table-cell; }
  #gauge_div { width: 120px; margin: 0 auto; }
  */
</style>



  <title>Google Gauge - ThingSpeak</title>
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
<script type='text/javascript' src='https://www.google.com/jsapi'></script>
<script type='text/javascript'>
   // set your channel id here
  var channel_id = 1289568;
  // set your channel's read api key here if necessary
  var api_key = 'C3O58RRHRTD78GVU';
  // maximum value for the gauge
  //var max_gauge_value = 70;
  // name of the gauge
  //var gauge_name = 'Temp';

  // global variables
  var chart1, chart2, chart3, options1, options2, options3, charts, data;

  // load the google gauge visualization
  google.load('visualization', '1', {packages:['gauge']});
  google.setOnLoadCallback(initCharts);
  
  
  setInterval('chartReload()', 10 * 60 * 1000);
  //setInterval('chartReload()',  3000);
  
  

  // initialize the chart
  function initCharts() {

    data = new google.visualization.DataTable();
    data.addColumn('string', 'Label');
    data.addColumn('number', 'Value');
    data.addRows(1);
    
    chart1 = new google.visualization.Gauge(document.getElementById('gauge_div_temp'));
    options1 = {width: 250, height: 250, 
               min: 20, max: 36,
               // RED
               greenFrom: 20, greenTo: 36, greenColor: '#DC3912',
               // GREEN
               redFrom: 27, redTo: 31, redColor: '#109618',
               // YELLOW
               yellowFrom:24, yellowTo: 34, yellowColor: 'yellow',
               animation:{
                duration: 2000,
                easing: 'inAndOut',
                },
               majorTicks: [
                '20', '22',  '24', '26',  '28', '30', '32', '34', '36' ]
              };
			  
	chart2 = new google.visualization.Gauge(document.getElementById('gauge_div_humi'));
    options2 = {width: 250, height: 250, 
               min: 0, max: 100,
               // RED
               greenFrom: 0, greenTo: 50, greenColor: '#DC3912',
               // GREEN
               redFrom: 70, redTo: 100, redColor: '#109618',
               // YELLOW
               yellowFrom:50, yellowTo: 70, yellowColor: 'yellow',
               animation:{
                duration: 2000,
                easing: 'inAndOut',
                },
               majorTicks: [
                '0', '20', '40',  '60', '80',  '100' ]
              };
			  
	chart3 = new google.visualization.Gauge(document.getElementById('gauge_div_heat'));
    options3 = {width: 250, height: 250, 
               min: 0, max: 1,
			   /*
               // RED
               greenFrom: 0, greenTo: 50, greenColor: '#DC3912',
               // GREEN
               redFrom: 70, redTo: 100, redColor: '#109618',
               // YELLOW
               yellowFrom:50, yellowTo: 70, yellowColor: 'yellow',
               animation:{
                duration: 2000,
                easing: 'inAndOut',
                },
				*/
               majorTicks: [
                'OFF', 'ON' ]
				
              };
			  
    loadData();

    // load new data every 15 seconds
    setInterval('loadData()', 5000);
  }
  
  
   // load the data
  function loadData() {
    // variable for the data point
    var t, h, heat;

    // get the data from thingspeak
    $.getJSON('https://api.thingspeak.com/channels/' + channel_id + '/feed/last.json?api_key=' + api_key, function(data) {

      // get the data point
      temp = data.field1;
	  humi = data.field2;
	  heat = data.field3;
      
      // if there is a data point display it
      if (temp) {
        // p = Math.round((p / max_gauge_value) * 100);
        displayDataTemp(temp);
      }
	  
	  if (humi) {
        // p = Math.round((p / max_gauge_value) * 100);
        displayDataHumi(humi);
      }
	  
	  if (heat) {
        // p = Math.round((p / max_gauge_value) * 100);
        displayDataHeat(heat);
      }
	  else
	  	  displayDataHeat(0);
    });
  }
  
  
  // display the data
  function displayDataTemp(point) {
    data.setValue(0, 0, 'Temp');
    data.setValue(0, 1, point);
    
     var formatter = new google.visualization.NumberFormat(
          {suffix: 'Â°C',pattern:'#.#'}
          );
        formatter.format(data,1);
    
    chart1.draw(data, options1);
}
  
  // display the data
  function displayDataHumi(point) {
    data.setValue(0, 0, 'Humi');
    data.setValue(0, 1, point);
    
     var formatter = new google.visualization.NumberFormat(
          {suffix: '%',pattern:''}
          );
        formatter.format(data,1);
    
   chart2.draw(data, options2);
  }
  
  // display the data
  function displayDataHeat(point) {
    data.setValue(0, 0, 'Heat');
    data.setValue(0, 1, point);
    
     var formatter = new google.visualization.NumberFormat(
          {suffix: '',pattern:'#'}
          );
        formatter.format(data,1);
    
   chart3.draw(data, options3);
  }

/*
function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['2021-01-25 13:00:00.000', 'Temp'],
          ['2021-01-26 13:00:00.000',  20],
          ['2021-01-27 13:00:00.000',  21],
          ['2021-01-28 13:00:00.000',  23],
          ['2021-01-29 13:00:00.000',  25]
        ]);
		
		 var data = new google.visualization.DataTable();
		data.addColumn('date', 'Date');
		data.addColumn('number', 'Temp');
		
		data.addRows([
		 [Date.parse('2021-01-25'), 'Temp'],
          ['2021-01-26 13:00:00',  20],
          ['2021-01-27 13:00:00',  21],
          ['2021-01-28 13:00:00',  23],
          ['2021-01-29 13:00:00',  25]
		  ]);
		
        var options = {
          title: 'Temperature',
          curveType: 'function',
          legend: { position: 'bottom' }
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

         
        chart.draw(data, options);
      }
  
	  google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);
	*/  
 
/*
  function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses'],
          ['2004',  1000,      400],
          ['2005',  1170,      460],
          ['2006',  660,       1120],
          ['2007',  1030,      540]
        ]);

        var options = {
          title: 'Company Performance',
          curveType: 'function',
          legend: { position: 'bottom' }
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

         
        chart.draw(data, options);
      }
  
	  google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);
*/
	
	function chartReload(){
		document.getElementById('iframe1').src = document.getElementById('iframe1').src;
		document.getElementById('iframe2').src = document.getElementById('iframe2').src;
		document.getElementById('iframe3').src = document.getElementById('iframe3').src;
	}
  </script>
 
 


  </head>

  <body>
    <div id="container" >
	<div style="text-align:center; ">
		<h1 style="font-family: 'Helvetica Neue', 'Lucida Grande', 'Segoe UI', Arial, Helvetica, Verdana, sans-serif;"> Temperature & Humidity Monitoring </h1>
	</div>
		<div id="inner1" style="height:250px; width:1500px; margin:auto;">
			<div id="gauge_div_temp"></div>
			<iframe id="iframe1" width="1200" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1289568/charts/1?bgcolor=%23ffffff&color=%23d62020&days=1&dynamic=true&round=0%2C5&timescale=15&title=Temperature&type=line&width=1200&type=spline"></iframe>
		</div>
		<div id="inner1" style="height:250px; width:1500px; margin:auto; padding-top:20px;">
			<div id="gauge_div_humi"></div>
			<iframe id="iframe2" width="1200" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1289568/charts/2?bgcolor=%23ffffff&color=%23d62020&days=1&dynamic=true&timescale=15&title=Humidity&type=line&yaxismin=0&yaxismax=100&width=1200&type=spline"></iframe>
		</div>
		<div id="inner1" style="height:250px; width:1500px; margin:auto; padding-top:20px;">
			<div id="gauge_div_heat"></div>
			<iframe id="iframe3" width="1200" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1289568/charts/3?bgcolor=%23ffffff&color=%23d62020&days=1&dynamic=true&timescale=15&title=Heating&type=line&yaxismin=0&yaxismax=1&width=1200&type=spline"></iframe>
		</div>
      
	  <div id="curve_chart" style="width: 800px; height:0px"></div>
	 </div>
  </body>
</html>

